!function(){"use strict";var e="style-module_speecher__ZAYi-",t="style-module_button__jq3AX",o="style-module_row__H2sPc",s="style-module_title__Hei5S",n="style-module_err__g8zge",i="style-module_active__ssQXz",l="style-module_inactive__gXEdI";!function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var s=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===o&&s.firstChild?s.insertBefore(n,s.firstChild):s.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}('*{box-sizing:border-box}body,html{height:100%;margin:0;overflow:hidden;padding:0;width:100%}.style-module_speecher__ZAYi-{font-family:Inter var,Inter,-apple-system,"system-ui",system-ui,Segoe UI,Roboto,Helvetica Neue,Ubuntu,sans-serif}body{align-items:center;background-color:#fff;display:flex;flex-direction:column;justify-content:center;margin:0;overflow:hidden;padding:1rem}.style-module_button__jq3AX{background-color:#3c92dc;border:1px solid #266ebd;border-radius:3px;color:#fff;cursor:pointer;font-size:.7rem;margin:.3rem;padding:4px;pointer-events:all;width:80px}.style-module_button__jq3AX:hover{background-color:#3282ce;border:1px solid #1f60ae}.style-module_row__H2sPc{display:flex}.style-module_title__Hei5S{font-size:.9rem}.style-module_err__g8zge,.style-module_title__Hei5S{align-items:center;display:flex;flex-direction:column;justify-content:center;pointer-events:none;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none}.style-module_err__g8zge{background-color:hsla(0,100%,95%,.85);font-size:.8rem;height:100%;left:0;position:absolute;top:0;width:100%}.style-module_active__ssQXz{opacity:1;pointer-events:all}.style-module_inactive__gXEdI{opacity:.5;pointer-events:none}');const d=window.Retool;let r,c,a;const u={"not-allowed":'You need to allow "Microphone" and "Storage and cookies" in Custom Component panel.',"no-speech":"Stop due no speech around."};let m,p=!1,y=!1,_=!1;const g=[],b=()=>{r.classList.remove(i,l),c.classList.remove(i,l)},h=e=>{console.log("buildSpeecher");const{continuous:t=!1,interimResults:o=!0,lang:s="en-US",maxAlternatives:n=1,keepActive:p=!0}=e||{};m=new webkitSpeechRecognition,m.continuous=t,m.interimResults=o,m.lang=s,m.maxAlternatives=n,m.onresult=e=>{const t=e.results[0],o=t[0].transcript.trim();t.isFinal&&(g.push(o),d.modelUpdate({lastMessage:o,messages:g}))},m.onstart=function(){console.log("onstart"),a.style.visibility="hidden",_=!1,b(),c.classList.add(i),r.classList.add(l)},m.onerror=function(e){console.log("onerror",e),b(),r.classList.add(l),c.classList.add(l),a.style.visibility="visible",a.innerHTML=u[e.error],"no-speech"===e.error&&p||(a.style.visibility="visible",_=!0)},m.onend=function(){_||(console.log("onend"),b(),r.classList.add(i),c.classList.add(l),p&&!y&&v())}},v=()=>{y=!1,m.start()},f=()=>{y=!0,m.stop()};d.subscribe((i=>{const d=i||{};d?.lastMessage||d?.messages||console.log("Speech2Text: model changed from editor"),p||((i=>{console.log("buildUI"),document.body.classList.add(e);const d=document.createElement("div");d.classList.add(s),d.innerHTML="Speech-2-Text (v0.0.13)",document.body.append(d),a=document.createElement("div"),a.classList.add(n),a.style.visibility="hidden",window.SpeechRecognition||window.webkitSpeechRecognition||(a.style.visibility="visible",a.innerHTML="Your browser is not supported, sorry.");const u=document.createElement("div");u.classList.add(o),document.body.append(u),r=document.createElement("button"),r.textContent="Start",r.classList.add(t),u.append(r),r.addEventListener("click",(()=>{m||h(i),v()})),c=document.createElement("button"),c.textContent="Stop",c.classList.add(t,l),u.append(c),c.addEventListener("click",(()=>{f()})),document.body.append(a)})(d),p=!0)}))}();
